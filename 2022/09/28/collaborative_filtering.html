<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Collaborative filtering from scratch | fastpages</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Collaborative filtering from scratch" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An easy to use blogging platform with support for Jupyter Notebooks." />
<meta property="og:description" content="An easy to use blogging platform with support for Jupyter Notebooks." />
<link rel="canonical" href="https://hd702.github.io/blog/2022/09/28/collaborative_filtering.html" />
<meta property="og:url" content="https://hd702.github.io/blog/2022/09/28/collaborative_filtering.html" />
<meta property="og:site_name" content="fastpages" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-09-28T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Collaborative filtering from scratch" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-09-28T00:00:00-05:00","datePublished":"2022-09-28T00:00:00-05:00","description":"An easy to use blogging platform with support for Jupyter Notebooks.","headline":"Collaborative filtering from scratch","mainEntityOfPage":{"@type":"WebPage","@id":"https://hd702.github.io/blog/2022/09/28/collaborative_filtering.html"},"url":"https://hd702.github.io/blog/2022/09/28/collaborative_filtering.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://hd702.github.io/blog/feed.xml" title="fastpages" /><link rel="shortcut icon" type="image/x-icon" href="/blog/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/blog/">fastpages</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/blog/about/">About Me</a><a class="page-link" href="/blog/search/">Search</a><a class="page-link" href="/blog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Collaborative filtering from scratch</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-09-28T00:00:00-05:00" itemprop="datePublished">
        Sep 28, 2022
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      1 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/hd702/blog/tree/master/_notebooks/collaborative_filtering.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/blog/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/hd702/blog/master?filepath=_notebooks%2Fcollaborative_filtering.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blog/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/hd702/blog/blob/master/_notebooks/collaborative_filtering.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blog/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
          <div class="px-2">
  <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2Fhd702%2Fblog%2Fblob%2Fmaster%2F_notebooks%2Fcollaborative_filtering.ipynb" target="_blank">
      <img class="notebook-badge-image" src="/blog/assets/badges/deepnote.svg" alt="Launch in Deepnote"/>
  </a>
</div>

        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/collaborative_filtering.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastai.tabular.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">fastai.collab</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span>  <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">ML_100k</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Path</span><span class="o">.</span><span class="n">BASE_PATH</span> <span class="o">=</span> <span class="n">path</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;u.data&#39;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Path(&#39;u.data&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ratings</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;u.data&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="s1">&#39;movie&#39;</span><span class="p">,</span> <span class="s1">&#39;rating&#39;</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">])</span>
<span class="n">ratings</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user</th>
      <th>movie</th>
      <th>rating</th>
      <th>timestamp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>196</td>
      <td>242</td>
      <td>3</td>
      <td>881250949</td>
    </tr>
    <tr>
      <th>1</th>
      <td>186</td>
      <td>302</td>
      <td>3</td>
      <td>891717742</td>
    </tr>
    <tr>
      <th>2</th>
      <td>22</td>
      <td>377</td>
      <td>1</td>
      <td>878887116</td>
    </tr>
    <tr>
      <th>3</th>
      <td>244</td>
      <td>51</td>
      <td>2</td>
      <td>880606923</td>
    </tr>
    <tr>
      <th>4</th>
      <td>166</td>
      <td>346</td>
      <td>1</td>
      <td>886397596</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">movies</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;u.item&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin-1&#39;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;movie&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">],</span> <span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">movies</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie</th>
      <th>title</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Toy Story (1995)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>GoldenEye (1995)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Four Rooms (1995)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Get Shorty (1995)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Copycat (1995)</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1677</th>
      <td>1678</td>
      <td>Mat' i syn (1997)</td>
    </tr>
    <tr>
      <th>1678</th>
      <td>1679</td>
      <td>B. Monkey (1998)</td>
    </tr>
    <tr>
      <th>1679</th>
      <td>1680</td>
      <td>Sliding Doors (1998)</td>
    </tr>
    <tr>
      <th>1680</th>
      <td>1681</td>
      <td>You So Crazy (1994)</td>
    </tr>
    <tr>
      <th>1681</th>
      <td>1682</td>
      <td>Scream of Stone (Schrei aus Stein) (1991)</td>
    </tr>
  </tbody>
</table>
<p>1682 rows Ã— 2 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mr</span> <span class="o">=</span> <span class="n">ratings</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">movies</span><span class="p">)</span>
<span class="n">mr</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user</th>
      <th>movie</th>
      <th>rating</th>
      <th>timestamp</th>
      <th>title</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>196</td>
      <td>242</td>
      <td>3</td>
      <td>881250949</td>
      <td>Kolya (1996)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>63</td>
      <td>242</td>
      <td>3</td>
      <td>875747190</td>
      <td>Kolya (1996)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>226</td>
      <td>242</td>
      <td>5</td>
      <td>883888671</td>
      <td>Kolya (1996)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>154</td>
      <td>242</td>
      <td>3</td>
      <td>879138235</td>
      <td>Kolya (1996)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>306</td>
      <td>242</td>
      <td>5</td>
      <td>876503793</td>
      <td>Kolya (1996)</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">CollabDataLoaders</span><span class="o">.</span><span class="n">from_df</span><span class="p">(</span><span class="n">mr</span><span class="p">,</span> <span class="n">item_name</span><span class="o">=</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>CollabDataLoaders needs three data: user, item and rating. If we don't tell the name of the data(column), for example, user_name='user', then 'user_name'=column0, 'movie_name'=column1 and 'rating_name'=column2</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">create_params</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="o">*</span><span class="n">size</span><span class="p">)</span><span class="o">.</span><span class="n">normal_</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">create_params</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Parameter containing:
tensor([[-0.0066,  0.0092, -0.0006],
        [-0.0032, -0.0003, -0.0001],
        [-0.0003,  0.0193, -0.0045]], requires_grad=True)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">DotProductBias</span><span class="p">(</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_users</span><span class="p">,</span> <span class="n">n_movies</span><span class="p">,</span> <span class="n">n_factors</span><span class="p">,</span> <span class="n">y_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">5.5</span><span class="p">)):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user_factors</span> <span class="o">=</span> <span class="n">create_params</span><span class="p">([</span><span class="n">n_users</span><span class="p">,</span> <span class="n">n_factors</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user_bias</span> <span class="o">=</span> <span class="n">create_params</span><span class="p">([</span><span class="n">n_users</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">movie_factors</span> <span class="o">=</span> <span class="n">create_params</span><span class="p">([</span><span class="n">n_movies</span><span class="p">,</span> <span class="n">n_factors</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">movie_bias</span> <span class="o">=</span> <span class="n">create_params</span><span class="p">([</span><span class="n">n_movies</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_range</span> <span class="o">=</span> <span class="n">y_range</span>
        
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">users</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_factors</span><span class="p">[</span><span class="n">x</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">movies</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">movie_factors</span><span class="p">[</span><span class="n">x</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]]</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">users</span><span class="o">*</span><span class="n">movies</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_bias</span><span class="p">[</span><span class="n">x</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">movie_bias</span><span class="p">[</span><span class="n">x</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]]</span>
        <span class="k">return</span> <span class="n">sigmoid_range</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">y_range</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">dls</span><span class="o">.</span><span class="n">classes</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">dls</span><span class="o">.</span><span class="n">classes</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">mr</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">unique</span><span class="p">()),</span> <span class="nb">len</span><span class="p">(</span><span class="n">mr</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(944, 1665, 943, 1664)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Training-with-our-model">Training with our model<a class="anchor-link" href="#Training-with-our-model"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_users</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dls</span><span class="o">.</span><span class="n">classes</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">])</span>
<span class="n">n_movies</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dls</span><span class="o">.</span><span class="n">classes</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">DotProductBias</span><span class="p">(</span><span class="n">n_users</span><span class="p">,</span> <span class="n">n_movies</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">loss_func</span><span class="o">=</span><span class="n">MSELossFlat</span><span class="p">())</span>
<span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SuggestedLRs(valley=0.019054606556892395)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="n">wd</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.960600</td>
      <td>0.967294</td>
      <td>00:09</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.893643</td>
      <td>0.906712</td>
      <td>00:09</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.749865</td>
      <td>0.865688</td>
      <td>00:09</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.551776</td>
      <td>0.843738</td>
      <td>00:08</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.381343</td>
      <td>0.846147</td>
      <td>00:09</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Training-with-collab_learner">Training with collab_learner<a class="anchor-link" href="#Training-with-collab_learner"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">collab_learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">n_factors</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">y_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">5.5</span><span class="p">))</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="n">wd</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>

</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.952338</td>
      <td>0.972281</td>
      <td>00:08</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.896477</td>
      <td>0.905513</td>
      <td>00:08</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.772317</td>
      <td>0.868070</td>
      <td>00:08</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.574562</td>
      <td>0.847296</td>
      <td>00:08</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.391383</td>
      <td>0.848967</td>
      <td>00:08</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

</div>



  </div><a class="u-url" href="/blog/2022/09/28/collaborative_filtering.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>An easy to use blogging platform with support for Jupyter Notebooks.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/fastai" target="_blank" title="fastai"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/fastdotai" target="_blank" title="fastdotai"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
